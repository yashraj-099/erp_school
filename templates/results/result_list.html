{% extends "base.html" %}
{% block content %}

<div class="d-flex {% if user.is_authenticated %}toggled{% endif %}" id="wrapper">
      {% if user.is_authenticated %}
        <div class="border-end bg-primary text-white" id="sidebar-wrapper" style="min-width:220px;">
          <div class="sidebar-heading text-center py-3 fw-bold">School ERP</div>
          <div class="list-group list-group-flush">
            <a href="/admin-dashboard/" class="list-group-item list-group-item-action bg-primary text-white"><i class="fa fa-home me-2"></i> Dashboard</a>
            <a href="/schools/" class="list-group-item list-group-item-action bg-primary text-white"><i class="fa-sharp-duotone fa-solid fa-school"></i> Schools</a>
            <a href="/students/" class="list-group-item list-group-item-action bg-primary text-white"><i class="fa fa-user-graduate me-2"></i> Students</a>
            <a href="/teachers/" class="list-group-item list-group-item-action bg-primary text-white"><i class="fa fa-chalkboard-teacher me-2"></i> Teachers</a>
            <a href="/subjects/" class="list-group-item list-group-item-action bg-primary text-white"><i class="fa fa-book me-2"></i> Subjects</a>
            <a href="/fees/" class="list-group-item list-group-item-action bg-primary text-white"><i class="fa fa-wallet me-2"></i> Fees</a>
            <a href="/results/" class="list-group-item list-group-item-action bg-primary text-white"><i class="fa fa-calendar-alt me-2"></i> Results</a>
            <a href="/events/" class="list-group-item list-group-item-action bg-primary text-white"><i class="fa fa-calendar-alt me-2"></i> Events</a>
          </div>
        </div>
      {% endif %}
      <div id="page-content-wrapper"
        style="{% if user.is_authenticated %}
          width:100%;
        {% else %}
          width:100%; margin-left:0;
        {% endif %}">

        <!--   nav bar    -->

        <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
          <div class="container-fluid">
            {% comment %} {% if user.is_authenticated %} {% endcomment %}
              <button class="btn btn-primary" id="sidebarToggle"><i class="fa fa-bars"></i></button>
            {% comment %} {% endif %} {% endcomment %}
            <div class="ms-auto">
              {% if user.is_authenticated %}
                <span class="me-3">{{ user.username }}</span>
                <a href="/logout/" class="btn btn-outline-secondary btn-sm">Logout</a>
              {% else %}
                <a href="/login/" class="btn btn-outline-primary btn-sm">Login</a>
              {% endif %}
            </div>
          </div>
        </nav>

<div class="container mt-4">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h4>Student Results</h4>
        <a href="{% url 'add_result' %}" class="btn btn-primary">
            + Add Result
        </a>
    </div>

    <div class="card shadow-sm">
        <div class="card-body">

<table class="table table-bordered table-hover">
    <thead class="table-light">
        <tr>
            <th>#</th>
            <th>Student</th>
            <th>Subject</th>
            <th>Marks</th>
            <th>Total</th>
            <th>Exam Date</th>
            <th>Actions</th>
        </tr>
    </thead>

    <tbody>
        {% for r in results %}
        <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ r.student.name }}</td>
            <td>{{ r.subject.name }}</td>
            <td>{{ r.marks_obtained }}</td>
            <td>{{ r.total_marks }}</td>
            <td>{{ r.exam_date }}</td>

            <!--  ACTION BUTTONS -->
            <td>
                <a href="{% url 'edit_result' r.id %}"
                   class="btn btn-sm btn-warning">
                    Edit
                </a>

                <a href="{% url 'delete_result' r.id %}"
                onclick="return confirm('Are you sure you want to delete this result?')"
                   class="btn btn-sm btn-danger">
                    Delete
                </a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="7" class="text-center text-muted">
                No results found
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>


        </div>
    </div>

</div>

{% endblock %}
